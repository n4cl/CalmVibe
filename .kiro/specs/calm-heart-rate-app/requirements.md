# Requirements Document

## Introduction
不安や動揺で鼓動が高まったときに、**一定リズムの振動へ身体を同期させて落ち着きを取り戻す**ことを主目的とするスマホアプリMVP。必要に応じて視覚呼吸ガイドを補助として提示する。心拍は手入力でセッション前後を記録・振り返りできる（心拍データの自動計測・同期は行わない）。

## Requirements

### Requirement 1: 振動リズム設定（BPM指定）
**Objective:** ユーザーとして、心拍を合わせたい振動リズム（BPM相当）を事前に決めておきたい。なぜなら発作時に即座に同期を始めたいから。

#### Acceptance Criteria
1. 設定画面で、リズム振動の間隔をBPM相当（例: 40〜90 BPM、1刻み）で入力またはスライダー選択し、保存できること。
2. 設定画面で、振動パターン（例: シンプル、パルス、ウェーブ）と強度を選択・保存できること。
3. 設定変更後、プレビューで選択したパターン・強度を反映した複数回の振動を再生し、体感を確認できること（Webでは無振動だが落ちないこと）。
4. 保存した振動設定は次回セッション開始時に自動適用されること。
5. セッション時間（例: 1〜5分の範囲、初期値3分）を設定画面で設定・保存できること。

### Requirement 2: リズム振動ガイド提示（視覚は任意補助）
**Objective:** ユーザーとして、最小操作で一定リズムの振動ガイドを開始・停止し、心拍を同期させたい。必要に応じて視覚ガイドも同期表示したい。

#### Acceptance Criteria
1. 「鎮静開始」をタップすると、事前設定のBPMとパターンで振動ガイドを即時開始できること（モード選択はデフォルトで振動優先、視覚ガイドはオン/オフ切替可能）。
2. 振動は設定BPMに対して±5%以内の間隔で継続的にトリガーされること。
3. 視覚ガイド（円の鼓動/拡大縮小など）は振動と同期した周期で表示でき、オフにしても振動ガイドは継続すること。
4. セッションは設定時間経過またはユーザーの手動停止のどちらか早い方で確実に停止し、終了メッセージを表示すること。

### Requirement 3: 呼吸ガイド（オプション）
**Objective:** ユーザーとして、必要に応じて呼吸テンポプリセットで視覚ガイドを使いたい。なぜなら状況によって呼吸に意識を向けたい時があるから。

#### Acceptance Criteria
1. 呼吸ガイドのテンポプリセット（例: 4-6-4秒、5-5-5秒など）を選択・保存できること（振動設定とは独立保持）。
2. 呼吸ガイドを有効化した場合、開始時に選択テンポで視覚ガイドが提示され、振動ガイドは無効または選択に応じて同周期で動作すること。
3. 呼吸ガイドを無効にすると振動ガイドのみで開始できること。

### Requirement 4: セッション記録と振り返り
**Objective:** ユーザーとして、セッション前後の状態や体感を記録して後から振り返りたい。なぜなら、効果を把握し次回に活かしたいから。

#### Acceptance Criteria
1. セッション開始前に、現在の心拍数を手入力で記録できること（未入力の場合は記録不要として進行できること）。
2. セッション終了直後に、終了時の心拍数を手入力で記録できること。
3. セッション終了時に、使用したガイド種別（振動ガイド／呼吸ガイド／併用）を選択して保存できること。
4. セッション終了時に、体感（落ち着き度合い、ガイドの心地よさ、振動の強さの感じ方など）を3〜5段階で入力して保存できること。
5. セッション終了時に、改善度合いを5段階で評価して保存できること。
6. 記録したセッション履歴を一覧で確認でき、各セッションの開始前後心拍・ガイド種別・体感入力・改善度合いが閲覧できること。
